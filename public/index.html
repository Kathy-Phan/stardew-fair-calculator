<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grange Fair Score Calculator</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Short+Stack&display=swap">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="modal.css">
    
</head>
<body>
    <div id="app">
        <div class="left-column-container">
            <div class="top-card">
                <h1>Stardew Valley Grange Fair Calculator</h1>
                
                <p>This is a <b>fan-made</b> calculator, built to simplify calculating points in the Grange Display for the <i>Stardew Valley Fair</i>. </p>
                <br>

                <!-- Search Bar -->
                <div id="search-bar">
                    <div class="row">
                        <img src="images/search-icon.png" alt="search icon" id="search-icon">
                        <input type="text" id="input-box" placeholder="Search items..." autocomplete="off" v-model="searchTerm">
                        <ul id="item-list"></ul>
                    </div>
                </div>
            </div>

            <div class="bottom-card">
                <!-- Profession Tabs -->
                <div class="professions">
                    <h3>Select Your Professions:</h3>

                    <div class="profession-tabs">
                        <button
                            v-for="prof in ['Base', 'Rancher', 'Mastery', 'Tapper', 'Tiller', 'Artisan', 'Fisher', 'Angler', 'Knowledge', 'Tiller+Knowledge', 'Gemologist']"
                            :key="prof"
                            @click="profession = prof"
                            :class="['item-profession', prof, {active: profession === prof}]"
                        >
                            <div v-if="prof === 'Tiller+Knowledge'" id="tiller_knowledge">
                                <img src="images/professions/tiller.png" class="tiller_img">
                                <p>+</p>
                                <img src="images/professions/knowledge.png" class="knowledge_img">
                            </div>
                            
                            <img v-else :src="prof == 'Base' ? 'images/stop.svg' : 'images/professions/' + prof.toLowerCase() + '.png'" id="profession-image">
    
                            <h4>{{ prof === 'Base' ? 'None' : prof }}</h4>
                        </button>
                    </div>
                </div>
    
                <!-- Category Tabs -->
                <div class="category-tabs">
                    <button
                        v-for="(category, index) in categories"
                        :key="index"
                        @click="activeTab = index"
                        :class="[{ active: activeTab == index }, category.category]"
                    >
                    {{ category.category }}
                    </button>
                </div>
    
                <div class="stardew-items">
                    <span v-if="filterItems.length == 0">No items</span>
                    <div
                        v-for="(item, index) in filterItems"
                        :key="index"
                    >
                        <div class="item-card">
                            <div id="item-image-and-name-container">
                                <div id="item-and-overlay-container">
                                    <!-- Item Image -->
                                    <img 
                                        v-if="item.image" 
                                        :src="item.image" 
                                        :alt="item.name" 
                                        class="item-image"
                                    >
                                    <!-- Item image overlay for Artisan Goods -->
                                    <img
                                        v-if="categories[activeTab].category == 'Artisan Good' || 'All'"
                                        :src="getOverlayImage(item.name)"
                                        class="overlay-image"
                                    >
                                </div>
    
                                <div id="item-name-and-prof-container">
                                    <!-- Item name in card -->
                                    <span 
                                        class="item-name">
                                        {{ item.name }}
                                    </span>
                                    <!-- Profession name in card -->
                                    <div 
                                        v-if="item.type !== 'Base'"
                                        :class="['item-profession', item.type.toLowerCase()]"
                                    >
                                        {{ item.type }}
                                    </div>
                                </div>
                            </div>
                            
                            <div id="points-btn-container">
                                <button
                                    v-for="(points, quality) in item.quality"
                                    :key="quality"
                                    @click="addItem(item, quality, categories[activeTab])"
                                >
                                    <div id="item-star-container">
                                        <img 
                                            v-if="quality !== 'normal'"
                                            :src="'images/' + quality + '.png'"
                                            class="quality-image"
                                        />
                                    </div>
                                    <div>{{ points ?? 0 }}pts</div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <footer>
                All information & images are sourced from <i>Stardew Valley</i> &copy; ConcernedApe.
            </footer>
        </div>
        
        <div class="right-card">
                <h3>Selected Items: ({{ uniqueItems.reduce((sum, item) => sum + item.quantity, 0) }}/9)</h3>
                <button @click="clearAll">Clear</button>
                <hr>
                <div class="cart-container">
                    <div v-for="item in uniqueItems" :key="item.id" class="cart-items">
                        <div class="cart-item-left">
                            <img :src="item.image" :alt="item.name" class="item-image">
                            <div 
                                v-if="item.type !== 'Base'" 
                                :class="['cart-item-profession', item.type.toLowerCase()]">
                                {{ item.type }}
                            </div>
                        </div>
                        <div class="cart-item-right">
                            <span class="item-name">{{ item.name }} </span>
                            <br>
                            <span>{{ item.points ?? 0}}pts</span>
                            &nbsp;
                            <img 
                                v-if="item.quality !== 'normal'"
                                :src="'images/' + item.quality + '.png'"
                            >
                            <div id="quantity-selector-box">
                                <div id="quantity-selector">
                                    <button class="cart-btn" @click="decrementItem(item.id)">-</button>
                                    <span class="item-count">{{ item.quantity }}</span>
                                    <button class="cart-btn" @click="incrementItem(item)">+</button>
                                </div>
                                <button class="cart-btn" @click="removeItem(item.id)">Remove</button>
                            </div>
                        </div>
                    </div>
                </div>  
        
                <hr>
                                
                <h2>Current Score</h2>
                <div id="score-calculation">
                    <p>Base Points: {{ score.base }}</p>
                    <p>Unique Categories ({{ Math.min(getUniqueCategories().length, 6) }}/6): {{ score.category }}</p>
                    <p>Item Points: {{ score.sumItems }}</p>
                    <p>Total Score: {{ score.total }}</p>
                </div>
            </div>
    </div>
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="script.js"></script>
</body>
</html>
